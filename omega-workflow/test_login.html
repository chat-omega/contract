<!DOCTYPE html>
<html>
<head>
    <title>Login Test</title>
</head>
<body>
    <h1>Login Test</h1>
    <button onclick="testLogin()">Test Login</button>
    <div id="result"></div>
    
    <script>
    async function testLogin() {
        const resultDiv = document.getElementById('result');
        resultDiv.innerHTML = 'Testing...';
        
        try {
            console.log('Making request to: /api/auth/login');
            
            const response = await fetch('/api/auth/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify({
                    username: 'admin',
                    password: 'admin123'
                })
            });

            console.log(`Response status: ${response.status}, Content-Type: ${response.headers.get('content-type')}`);
            
            // Get response text first to handle empty responses
            const responseText = await response.text();
            console.log(`Response text length: ${responseText.length}`);
            console.log('Response text:', responseText.substring(0, 200));
            
            let result;
            if (responseText.trim()) {
                try {
                    result = JSON.parse(responseText);
                    console.log('Parsed JSON:', result);
                    resultDiv.innerHTML = `<pre>SUCCESS:\n${JSON.stringify(result, null, 2)}</pre>`;
                } catch (parseError) {
                    console.error('JSON parse error:', parseError);
                    console.error('Response text:', responseText);
                    resultDiv.innerHTML = `<pre>PARSE ERROR:\n${parseError.message}\n\nResponse:\n${responseText}</pre>`;
                }
            } else {
                console.warn('Empty response received');
                result = {};
                resultDiv.innerHTML = '<pre>EMPTY RESPONSE</pre>';
            }
            
        } catch (error) {
            console.error('Request error:', error);
            resultDiv.innerHTML = `<pre>REQUEST ERROR:\n${error.message}</pre>`;
        }
    }
    </script>
</body>
</html>